{"version":3,"file":"fuse.es6.min.js","sources":["../src/search/bitap-search/bitap-score.js","../src/search/bitap-search/bitap-matched-indices.js","../src/search/bitap-search/bitap-search.js","../src/search/bitap-search/bitap-pattern-alphabet.js","../src/search/bitap-search/constants.js","../src/search/bitap-search/index.js","../src/search/extended-search/exact-match.js","../src/search/extended-search/inverse-exact-match.js","../src/search/extended-search/prefix-exact-match.js","../src/search/extended-search/inverse-prefix-exact-match.js","../src/search/extended-search/suffix-exact-match.js","../src/search/extended-search/inverse-suffix-exact-match.js","../src/helpers/type-checkers.js","../src/search/extended-search/index.js","../src/search/ngram-search/ngram.js","../src/search/ngram-search/array-utils/union.js","../src/search/ngram-search/array-utils/intersection.js","../src/search/ngram-search/array-utils/index.js","../src/search/ngram-search/distance/jaccard-distance.js","../src/search/ngram-search/distance/index.js","../src/search/ngram-search/index.js","../src/search/index.js","../src/helpers/get.js","../src/tools/create-index.js","../src/tools/key-store.js","../src/tools/index.js","../src/transform/transform-matches.js","../src/transform/transform-score.js","../src/transform/index.js","../src/index.js"],"sourcesContent":["module.exports = (pattern, { errors = 0, currentLocation = 0, expectedLocation = 0, distance = 100 }) => {\n  const accuracy = errors / pattern.length\n  const proximity = Math.abs(expectedLocation - currentLocation)\n\n  if (!distance) {\n    // Dodge divide by zero error.\n    return proximity ? 1.0 : accuracy\n  }\n\n  return accuracy + (proximity / distance)\n}\n","module.exports = (matchmask = [], minMatchCharLength = 1) => {\n  let matchedIndices = []\n  let start = -1\n  let end = -1\n  let i = 0\n\n  for (let len = matchmask.length; i < len; i += 1) {\n    let match = matchmask[i]\n    if (match && start === -1) {\n      start = i\n    } else if (!match && start !== -1) {\n      end = i - 1\n      if ((end - start) + 1 >= minMatchCharLength) {\n        matchedIndices.push([start, end])\n      }\n      start = -1\n    }\n  }\n\n  // (i-1 - start) + 1 => i - start\n  if (matchmask[i - 1] && (i - start) >= minMatchCharLength) {\n    matchedIndices.push([start, i - 1]);\n  }\n\n  return matchedIndices\n}\n","const bitapScore = require('./bitap-score')\nconst matchedIndices = require('./bitap-matched-indices')\n\nmodule.exports = (text, pattern, patternAlphabet, { location = 0, distance = 100, threshold = 0.6, findAllMatches = false, minMatchCharLength = 1, includeMatches = false }) => {\n  const patternLen = pattern.length\n  // Set starting location at beginning text and initialize the alphabet.\n  const textLen = text.length\n  // Handle the case when location > text.length\n  const expectedLocation = Math.max(0, Math.min(location, textLen))\n  // Highest score beyond which we give up.\n  let currentThreshold = threshold\n  // Is there a nearby exact match? (speedup)\n  let bestLocation = text.indexOf(pattern, expectedLocation)\n\n  // a mask of the matches\n  const matchMask = []\n  for (let i = 0; i < textLen; i += 1) {\n    matchMask[i] = 0\n  }\n\n  if (bestLocation !== -1) {\n    let score = bitapScore(pattern, {\n      errors: 0,\n      currentLocation: bestLocation,\n      expectedLocation,\n      distance\n    })\n    currentThreshold = Math.min(score, currentThreshold)\n\n    // What about in the other direction? (speed up)\n    bestLocation = text.lastIndexOf(pattern, expectedLocation + patternLen)\n\n    if (bestLocation !== -1) {\n      let score = bitapScore(pattern, {\n        errors: 0,\n        currentLocation: bestLocation,\n        expectedLocation,\n        distance\n      })\n      currentThreshold = Math.min(score, currentThreshold)\n    }\n  }\n\n  // Reset the best location\n  bestLocation = -1\n\n  let lastBitArr = []\n  let finalScore = 1\n  let binMax = patternLen + textLen\n\n  const mask = 1 << (patternLen <= 31 ? patternLen - 1 : 30)\n\n  for (let i = 0; i < patternLen; i += 1) {\n    // Scan for the best match; each iteration allows for one more error.\n    // Run a binary search to determine how far from the match location we can stray\n    // at this error level.\n    let binMin = 0\n    let binMid = binMax\n\n    while (binMin < binMid) {\n      const score = bitapScore(pattern, {\n        errors: i,\n        currentLocation: expectedLocation + binMid,\n        expectedLocation,\n        distance\n      })\n\n      if (score <= currentThreshold) {\n        binMin = binMid\n      } else {\n        binMax = binMid\n      }\n\n      binMid = Math.floor((binMax - binMin) / 2 + binMin)\n    }\n\n    // Use the result from this iteration as the maximum for the next.\n    binMax = binMid\n\n    let start = Math.max(1, expectedLocation - binMid + 1)\n    let finish = findAllMatches ? textLen : Math.min(expectedLocation + binMid, textLen) + patternLen\n\n    // Initialize the bit array\n    let bitArr = Array(finish + 2)\n\n    bitArr[finish + 1] = (1 << i) - 1\n\n    for (let j = finish; j >= start; j -= 1) {\n      let currentLocation = j - 1\n      let charMatch = patternAlphabet[text.charAt(currentLocation)]\n\n      if (charMatch) {\n        matchMask[currentLocation] = 1\n      }\n\n      // First pass: exact match\n      bitArr[j] = ((bitArr[j + 1] << 1) | 1) & charMatch\n\n      // Subsequent passes: fuzzy match\n      if (i !== 0) {\n        bitArr[j] |= (((lastBitArr[j + 1] | lastBitArr[j]) << 1) | 1) | lastBitArr[j + 1]\n      }\n\n      if (bitArr[j] & mask) {\n        finalScore = bitapScore(pattern, {\n          errors: i,\n          currentLocation,\n          expectedLocation,\n          distance\n        })\n\n        // This match will almost certainly be better than any existing match.\n        // But check anyway.\n        if (finalScore <= currentThreshold) {\n          // Indeed it is\n          currentThreshold = finalScore\n          bestLocation = currentLocation\n\n          // Already passed `loc`, downhill from here on in.\n          if (bestLocation <= expectedLocation) {\n            break\n          }\n\n          // When passing `bestLocation`, don't exceed our current distance from `expectedLocation`.\n          start = Math.max(1, 2 * expectedLocation - bestLocation)\n        }\n      }\n    }\n\n    // No hope for a (better) match at greater error levels.\n    const score = bitapScore(pattern, {\n      errors: i + 1,\n      currentLocation: expectedLocation,\n      expectedLocation,\n      distance\n    })\n\n    if (score > currentThreshold) {\n      break\n    }\n\n    lastBitArr = bitArr\n  }\n\n  let result = {\n    isMatch: bestLocation >= 0,\n    // Count exact matches (those with a score of 0) to be \"almost\" exact\n    score: !finalScore ? 0.001 : finalScore,\n  }\n\n  if (includeMatches) {\n    result.matchedIndices = matchedIndices(matchMask, minMatchCharLength)\n  }\n\n  return result\n}\n","module.exports = pattern => {\n  let mask = {}\n  let len = pattern.length\n\n  for (let i = 0; i < len; i += 1) {\n    mask[pattern.charAt(i)] = 0\n  }\n\n  for (let i = 0; i < len; i += 1) {\n    mask[pattern.charAt(i)] |= 1 << (len - i - 1)\n  }\n\n  return mask\n}","// Machine word size\nmodule.exports.MAX_BITS = 32","const bitapSearch = require('./bitap-search')\nconst patternAlphabet = require('./bitap-pattern-alphabet')\nconst { MAX_BITS } = require('./constants')\n\nclass BitapSearch {\n  constructor(pattern, {\n    // Approximately where in the text is the pattern expected to be found?\n    location = 0,\n    // Determines how close the match must be to the fuzzy location (specified above).\n    // An exact letter match which is 'distance' characters away from the fuzzy location\n    // would score as a complete mismatch. A distance of '0' requires the match be at\n    // the exact location specified, a threshold of '1000' would require a perfect match\n    // to be within 800 characters of the fuzzy location to be found using a 0.8 threshold.\n    distance = 100,\n    // At what point does the match algorithm give up. A threshold of '0.0' requires a perfect match\n    // (of both letters and location), a threshold of '1.0' would match anything.\n    threshold = 0.6,\n    // Indicates whether comparisons should be case sensitive.\n    isCaseSensitive = false,\n    // When true, the algorithm continues searching to the end of the input even if a perfect\n    // match is found before the end of the same input.\n    findAllMatches = false,\n    // Minimum number of characters that must be matched before a result is considered a match\n    minMatchCharLength = 1,\n\n    includeMatches = false\n  }) {\n    this.options = {\n      location,\n      distance,\n      threshold,\n      isCaseSensitive,\n      findAllMatches,\n      includeMatches,\n      minMatchCharLength\n    }\n\n    if (pattern.length > MAX_BITS) {\n      throw new Error(`Pattern length exceeds max of ${MAX_BITS}.`);\n    }\n\n    this.pattern = isCaseSensitive ? pattern : pattern.toLowerCase()\n    this.patternAlphabet = patternAlphabet(this.pattern)\n  }\n\n  searchIn(value) {\n    let text = value.$\n    return this.searchInString(text)\n  }\n\n  searchInString(text) {\n    const { isCaseSensitive, includeMatches } = this.options\n\n    if (!isCaseSensitive) {\n      text = text.toLowerCase()\n    }\n\n    // Exact match\n    if (this.pattern === text) {\n      let result = {\n        isMatch: true,\n        score: 0\n      }\n\n      if (includeMatches) {\n        result.matchedIndices = [[0, text.length - 1]]\n      }\n\n      return result\n    }\n\n    // Otherwise, use Bitap algorithm\n    const { location, distance, threshold, findAllMatches, minMatchCharLength } = this.options\n    return bitapSearch(text, this.pattern, this.patternAlphabet, {\n      location,\n      distance,\n      threshold,\n      findAllMatches,\n      minMatchCharLength,\n      includeMatches\n    })\n  }\n}\n\nmodule.exports = BitapSearch\n","// Token: 'file\n// Match type: exact-match\n// Description: Items that include `file`\n\nconst isForPattern = pattern => pattern.charAt(0) == \"'\"\n\nconst sanitize = pattern => pattern.substr(1)\n\nconst match = (pattern, text) => {\n  const sanitizedPattern = sanitize(pattern)\n  const index = text.indexOf(sanitizedPattern)\n  const isMatch = index > -1\n\n  return {\n    isMatch,\n    score: 0,\n  }\n}\n\nmodule.exports = {\n  isForPattern,\n  sanitize,\n  match\n}","// Token: !fire\n// Match type: inverse-exact-match\n// Description: Items that do not include `fire`\n\nconst isForPattern = pattern => pattern.charAt(0) == '!'\n\nconst sanitize = pattern => pattern.substr(1)\n\nconst match = (pattern, text) => {\n  const sanitizedPattern = sanitize(pattern)\n  const isMatch = text.indexOf(sanitizedPattern) === -1\n\n  return {\n    isMatch,\n    score: 0\n  }\n}\n\nmodule.exports = {\n  isForPattern,\n  sanitize,\n  match\n}","// Token: ^file\n// Match type: prefix-exact-match\n// Description: Items that start with `file`\n\nconst isForPattern = pattern => pattern.charAt(0) == '^'\n\nconst sanitize = pattern => pattern.substr(1)\n\nconst match = (pattern, text) => {\n  const sanitizedPattern = sanitize(pattern)\n  const isMatch = text.startsWith(sanitizedPattern)\n\n  return {\n    isMatch,\n    score: 0\n  }\n}\n\nmodule.exports = {\n  isForPattern,\n  sanitize,\n  match\n}","// Token: !^fire\n// Match type: inverse-prefix-exact-match\n// Description: Items that do not start with `fire`\n\nconst isForPattern = pattern => pattern.charAt(0) == '!' && pattern.charAt(1) == '^'\n\nconst sanitize = pattern => pattern.substr(2)\n\nconst match = (pattern, text) => {\n  const sanitizedPattern = sanitize(pattern)\n  const isMatch = !text.startsWith(sanitizedPattern)\n\n  return {\n    isMatch,\n    score: 0\n  }\n}\n\nmodule.exports = {\n  isForPattern,\n  sanitize,\n  match\n}","// Token: .file$\n// Match type: suffix-exact-match\n// Description: Items that end with `.file`\n\nconst isForPattern = pattern => pattern.charAt(pattern.length - 1) == '$'\n\nconst sanitize = pattern => pattern.substr(0, pattern.length - 1)\n\nconst match = (pattern, text) => {\n  const sanitizedPattern = sanitize(pattern)\n  const isMatch = text.endsWith(sanitizedPattern)\n\n  return {\n    isMatch,\n    score: 0\n  }\n}\n\nmodule.exports = {\n  isForPattern,\n  sanitize,\n  match\n}","// Token: !.file$\n// Match type: inverse-suffix-exact-match\n// Description: Items that do not end with `.file`\n\nconst isForPattern = pattern => pattern.charAt(0) == '!' && pattern.charAt(pattern.length - 1) == '$'\n\nconst sanitize = pattern => pattern.substring(1, pattern.length - 1)\n\nconst match = (pattern, text) => {\n  const sanitizedPattern = sanitize(pattern)\n  const isMatch = !text.endsWith(sanitizedPattern)\n\n  return {\n    isMatch,\n    score: 0\n  }\n}\n\nmodule.exports = {\n  isForPattern,\n  sanitize,\n  match\n}","const INFINITY = 1 / 0\n\nconst isArray = value => !Array.isArray\n  ? Object.prototype.toString.call(value) === '[object Array]'\n  : Array.isArray(value)\n\n// Adapted from:\n// https://github.com/lodash/lodash/blob/f4ca396a796435422bd4fd41fadbd225edddf175/.internal/baseToString.js\nconst baseToString = value => {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  let result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nconst toString = value => value == null ? '' : baseToString(value);\n\nconst isString = value => typeof value === 'string'\n\nconst isNumber = value => typeof value === 'number'\n\nconst isObject = value => typeof value === 'object'\n\nconst isDefined = value => value !== undefined && value !== null\n\nmodule.exports = {\n  isDefined,\n  isArray,\n  isString,\n  isNumber,\n  isObject,\n  toString\n}\n","const exactMatch = require('./exact-match')\nconst inverseExactMatch = require('./inverse-exact-match')\nconst prefixExactMatch = require('./prefix-exact-match')\nconst inversePrefixExactMatch = require('./inverse-prefix-exact-match')\nconst suffixExactMatch = require('./suffix-exact-match')\nconst inverseSuffixExactMatch = require('./inverse-suffix-exact-match')\nconst BitapSearch = require('../bitap-search')\n\nconst { isString } = require('../../helpers/type-checkers')\n\n// Return a 2D array representation of the query, for simpler parsing.\n// Example:\n// \"^core go$ | rb$ | py$ xy$\" => [[\"^core\", \"go$\"], [\"rb$\"], [\"py$\", \"xy$\"]]\nconst queryfy = (pattern) => pattern.split('|').map(item => item.trim().split(/ +/g))\n\n/**\n * Command-like searching\n * ======================\n *\n * Given multiple search terms delimited by spaces.e.g. `^jscript .python$ ruby !java`,\n * search in a given text.\n *\n * Search syntax:\n *\n * | Token       | Match type                 | Description                            |\n * | ----------- | -------------------------- | -------------------------------------- |\n * | `jscript`   | fuzzy-match                | Items that match `jscript`             |\n * | `'python`   | exact-match                | Items that include `python`            |\n * | `!ruby`     | inverse-exact-match        | Items that do not include `ruby`       |\n * | `^java`     | prefix-exact-match         | Items that start with `java`           |\n * | `!^earlang` | inverse-prefix-exact-match | Items that do not start with `earlang` |\n * | `.js$`      | suffix-exact-match         | Items that end with `.js`              |\n * | `!.go$`     | inverse-suffix-exact-match | Items that do not end with `.go`       |\n *\n * A single pipe character acts as an OR operator. For example, the following\n * query matches entries that start with `core` and end with either`go`, `rb`,\n * or`py`.\n *\n * ```\n * ^core go$ | rb$ | py$\n * ```\n */\nclass ExtendedSearch {\n  constructor(pattern, options) {\n    const { isCaseSensitive } = options\n    this.query = null\n    this.options = options\n    // A <pattern>:<BitapSearch> key-value pair for optimizing searching\n    this._fuzzyCache = {}\n\n    if (isString(pattern) && pattern.trim().length > 0) {\n      this.pattern = isCaseSensitive ? pattern : pattern.toLowerCase()\n      this.query = queryfy(this.pattern)\n    }\n  }\n\n  searchIn(value) {\n    const query = this.query\n\n    if (!this.query) {\n      return {\n        isMatch: false,\n        score: 1\n      }\n    }\n\n    let text = value.$\n\n    text = this.options.isCaseSensitive ? text : text.toLowerCase()\n\n    let matchFound = false\n\n    for (let i = 0, qLen = query.length; i < qLen; i += 1) {\n\n      const parts = query[i]\n      let result = null\n      matchFound = true\n\n      for (let j = 0, pLen = parts.length; j < pLen; j += 1) {\n        let token = parts[j]\n        result = this._search(token, text)\n        if (!result.isMatch) {\n          // AND condition, short-circuit and move on to next part\n          matchFound = false\n          break\n        }\n      }\n\n      // OR condition, so if TRUE, return\n      if (matchFound) {\n        return result\n      }\n    }\n\n    // Nothing was matched\n    return {\n      isMatch: false,\n      score: 1\n    }\n  }\n\n  _search(pattern, text) {\n    if (exactMatch.isForPattern(pattern)) {\n      return exactMatch.match(pattern, text)\n    } else if (prefixExactMatch.isForPattern(pattern)) {\n      return prefixExactMatch.match(pattern, text)\n    } else if (inversePrefixExactMatch.isForPattern(pattern)) {\n      return inversePrefixExactMatch.match(pattern, text)\n    } else if (inverseSuffixExactMatch.isForPattern(pattern)) {\n      return inverseSuffixExactMatch.match(pattern, text)\n    } else if (suffixExactMatch.isForPattern(pattern)) {\n      return suffixExactMatch.match(pattern, text)\n    } else if (inverseExactMatch.isForPattern(pattern)) {\n      return inverseExactMatch.match(pattern, text)\n    } else {\n      let searcher = this._fuzzyCache[pattern]\n      if (!searcher) {\n        searcher = new BitapSearch(pattern, this.options)\n        this._fuzzyCache[pattern] = searcher\n      }\n      return searcher.searchInString(text)\n    }\n  }\n}\n\nmodule.exports = ExtendedSearch","const NGRAM_LEN = 3\n\nmodule.exports = (text, { n = NGRAM_LEN, pad = true, sort = false }) => {\n  let nGrams = []\n\n  if (text === null || text === undefined) {\n    return nGrams\n  }\n\n  text = text.toLowerCase()\n  if (pad) {\n    text = ` ${text} `\n  }\n\n  let index = text.length - n + 1\n  if (index < 1) {\n    return nGrams\n  }\n\n  while (index--) {\n    nGrams[index] = text.substr(index, n)\n  }\n\n  if (sort) {\n    nGrams.sort((a, b) => a == b ? 0 : a < b ? -1 : 1)\n  }\n\n  return nGrams\n}","// Assumes arrays are sorted\nmodule.exports = (arr1, arr2) => {\n  let result = []\n  let i = 0\n  let j = 0\n\n  while (i < arr1.length && j < arr2.length) {\n    let item1 = arr1[i]\n    let item2 = arr2[j]\n\n    if (item1 < item2) {\n      result.push(item1)\n      i += 1\n    } else if (item2 < item1) {\n      result.push(item2)\n      j += 1\n    } else {\n      result.push(item2)\n      i += 1\n      j += 1\n    }\n  }\n\n  while (i < arr1.length) {\n    result.push(arr1[i])\n    i += 1\n  }\n\n  while (j < arr2.length) {\n    result.push(arr2[j])\n    j += 1\n  }\n\n  return result;\n}\n","// Assumes arrays are sorted\nmodule.exports = (arr1, arr2) => {\n  let result = []\n  let i = 0\n  let j = 0\n\n  while (i < arr1.length && j < arr2.length) {\n    let item1 = arr1[i]\n    let item2 = arr2[j]\n\n    if (item1 == item2) {\n      result.push(item1)\n      i += 1\n      j += 1\n    } else if (item1 < item2) {\n      i += 1\n    } else if (item1 > item2) {\n      j += 1\n    } else {\n      i += 1\n      j += 1\n    }\n  }\n\n  return result;\n}","module.exports = {\n  union: require('./union'),\n  intersection: require('./intersection')\n}","const { union, intersection } = require('../array-utils')\n\nmodule.exports = (nGram1, nGram2) => {\n  let nGramUnion = union(nGram1, nGram2)\n  let nGramIntersection = intersection(nGram1, nGram2)\n\n  return 1 - nGramIntersection.length / nGramUnion.length\n}","module.exports = {\n  jaccardDistance: require('./jaccard-distance')\n}","const ngram = require('./ngram')\nconst { jaccardDistance } = require('./distance')\n\nclass NGramSearch {\n  constructor(pattern, options = { threshold: 0.6 }) {\n    // Create the ngram, and sort it\n    this.options = options\n    this.patternNgram = ngram(pattern, { sort: true })\n  }\n  searchIn(value) {\n    let textNgram = value.ng\n    if (!textNgram) {\n      textNgram = ngram(value.$, { sort: true })\n      value.ng = textNgram\n    }\n\n    let jacardResult = jaccardDistance(this.patternNgram, textNgram)\n\n    const isMatch = jacardResult < this.options.threshold\n\n    return {\n      score: isMatch ? jacardResult : 1,\n      isMatch\n    }\n  }\n}\n\nmodule.exports = NGramSearch","module.exports = {\n  BitapSearch: require('./bitap-search'),\n  ExtendedSearch: require('./extended-search'),\n  NGramSearch: require('./ngram-search')\n}","const {\n  isDefined,\n  isString,\n  isNumber,\n  isArray,\n  toString\n} = require('./type-checkers')\n\nmodule.exports = (obj, path) => {\n  let list = []\n  let arr = false\n\n  const _get = (obj, path) => {\n    if (!path) {\n      // If there's no path left, we've gotten to the object we care about.\n      list.push(obj)\n    } else {\n      const dotIndex = path.indexOf('.')\n\n      let key = path\n      let remaining = null\n\n      if (dotIndex !== -1) {\n        key = path.slice(0, dotIndex)\n        remaining = path.slice(dotIndex + 1)\n      }\n\n      const value = obj[key]\n\n      if (isDefined(value)) {\n        if (!remaining && (isString(value) || isNumber(value))) {\n          list.push(toString(value))\n        } else if (isArray(value)) {\n          arr = true\n          // Search each item in the array.\n          for (let i = 0, len = value.length; i < len; i += 1) {\n            _get(value[i], remaining)\n          }\n        } else if (remaining) {\n          // An object. Recurse further.\n          _get(value, remaining)\n        }\n      }\n    }\n  }\n\n  _get(obj, path)\n\n  if (arr) {\n    return list\n  }\n\n  return list[0]\n}","const { isArray, isDefined, isString } = require('../helpers/type-checkers')\nconst get = require('../helpers/get')\nconst ngram = require('../search/ngram-search/ngram')\n\nmodule.exports = (keys, list, { getFn = get, ngrams = false } = {}) => {\n  let indexedList = []\n\n  // List is Array<String>\n  if (isString(list[0])) {\n    // Iterate over every string in the list\n    for (let i = 0, len = list.length; i < len; i += 1) {\n      const value = list[i]\n\n      if (isDefined(value)) {\n        // if (!isCaseSensitive) {\n        //   value = value.toLowerCase()\n        // }\n\n        let record = {\n          $: value,\n          idx: i\n        }\n\n        if (ngrams) {\n          record.ng = ngram(value, { sort: true })\n        }\n\n        indexedList.push(record)\n      }\n    }\n\n  } else {\n    // List is Array<Object>\n    const keysLen = keys.length\n\n    for (let i = 0, len = list.length; i < len; i += 1) {\n      let item = list[i]\n\n      let record = { idx: i, $: {} }\n\n      // Iterate over every key (i.e, path), and fetch the value at that key\n      for (let j = 0; j < keysLen; j += 1) {\n        let key = keys[j]\n        let value = getFn(item, key)\n\n        if (!isDefined(value)) {\n          continue\n        }\n\n        if (isArray(value)) {\n          let subRecords = []\n          const stack = [{ arrayIndex: -1, value }]\n\n          while (stack.length) {\n            const { arrayIndex, value } = stack.pop()\n\n            if (!isDefined(value)) {\n              continue\n            }\n\n            if (isString(value)) {\n\n              // if (!isCaseSensitive) {\n              //   v = v.toLowerCase()\n              // }\n\n              let subRecord = { $: value, idx: arrayIndex }\n\n              if (ngrams) {\n                subRecord.ng = ngram(value, { sort: true })\n              }\n\n              subRecords.push(subRecord)\n\n            } else if (isArray(value)) {\n              for (let k = 0, arrLen = value.length; k < arrLen; k += 1) {\n                stack.push({\n                  arrayIndex: k,\n                  value: value[k],\n                })\n              }\n            }\n          }\n          record.$[key] = subRecords\n        } else {\n          // if (!isCaseSensitive) {\n          //   value = value.toLowerCase()\n          // }\n\n          let subRecord = { $: value }\n\n          if (ngrams) {\n            subRecord.ng = ngram(value, { sort: true })\n          }\n\n          record.$[key] = subRecord\n        }\n      }\n\n      indexedList.push(record)\n    }\n  }\n\n  return indexedList\n}","const { isString } = require('../helpers/type-checkers')\n\nclass KeyStore {\n  constructor(keys) {\n    this._keys = {}\n    this._keyNames = []\n    this._length = keys.length\n\n    // Iterate over every key\n    if (keys.length && isString(keys[0])) {\n      for (let i = 0; i < this._length; i += 1) {\n        const key = keys[i]\n        this._keys[key] = {\n          weight: 1\n        }\n        this._keyNames.push(key)\n      }\n    } else {\n      let totalWeight = 0\n\n      for (let i = 0; i < this._length; i += 1) {\n        const key = keys[i]\n\n        if (!key.hasOwnProperty('name')) {\n          throw new Error('Missing \"name\" property in key object')\n        }\n\n        const keyName = key.name\n        this._keyNames.push(keyName)\n\n        if (!key.hasOwnProperty('weight')) {\n          throw new Error('Missing \"weight\" property in key object')\n        }\n\n        const weight = key.weight\n\n        if (weight <= 0 || weight >= 1) {\n          throw new Error('\"weight\" property in key must bein the range of (0, 1)')\n        }\n\n        this._keys[keyName] = {\n          weight\n        }\n\n        totalWeight += weight\n      }\n\n      // Normalize weights so that their sum is equal to 1\n      for (let i = 0; i < this._length; i += 1) {\n        const keyName = this._keyNames[i]\n        const keyWeight = this._keys[keyName].weight\n        this._keys[keyName].weight = keyWeight / totalWeight\n      }\n    }\n  }\n  get(key, name) {\n    return this._keys[key] ? this._keys[key][name] : -1\n  }\n  keys() {\n    return this._keyNames\n  }\n  count() {\n    return this._length\n  }\n  toJSON() {\n    return JSON.stringify(this._keys)\n  }\n}\n\nmodule.exports = KeyStore","module.exports = {\n  createIndex: require('./create-index'),\n  KeyStore: require('./key-store')\n}","const { isArray, isDefined, isString, isNumber, isObject } = require('../helpers/type-checkers')\n\nmodule.exports = (result, data) => {\n  const matches = result.matches\n  data.matches = []\n\n  if (!isDefined(matches)) {\n    return\n  }\n\n  for (let i = 0, len = matches.length; i < len; i += 1) {\n    let match = matches[i]\n\n    if (!isDefined(match.indices) || match.indices.length === 0) {\n      continue\n    }\n\n    let obj = {\n      indices: match.indices,\n      value: match.value\n    }\n\n    if (match.key) {\n      obj.key = match.key\n    }\n\n    if (match.idx > -1) {\n      obj.refIndex = match.idx\n    }\n\n    data.matches.push(obj)\n  }\n}\n","module.exports = (result, data) => {\n  data.score = result.score\n}","module.exports = {\n  transformMatches: require('./transform-matches'),\n  transformScore: require('./transform-score')\n}","\nconst { BitapSearch, ExtendedSearch, NGramSearch } = require('./search')\nconst { isArray, isDefined, isString, isNumber, isObject } = require('./helpers/type-checkers')\nconst get = require('./helpers/get')\nconst { createIndex, KeyStore } = require('./tools')\nconst { transformMatches, transformScore } = require('./transform')\nconst { MAX_BITS } = require('./search/bitap-search/constants')\n\n// // Will print to the console. Useful for debugging.\n// function debug() {\n//   if (Fuse.verbose) {\n//     console.log(...arguments)\n//     // const util = require('util')\n//     // console.log(util.inspect(...arguments, false, null, true /* enable colors */))\n//   }\n// }\n\n// function debugTime(value) {\n//   if (Fuse.verboseTime) {\n//     console.time(value)\n//   }\n// }\n\n// function debugTimeEnd(value) {\n//   if (Fuse.verboseTime) {\n//     console.timeEnd(value)\n//   }\n// }\n\nlet FuseOptions = {\n  // When true, the algorithm continues searching to the end of the input even if a perfect\n  // match is found before the end of the same input.\n  isCaseSensitive: false,\n  // Determines how close the match must be to the fuzzy location (specified above).\n  // An exact letter match which is 'distance' characters away from the fuzzy location\n  // would score as a complete mismatch. A distance of '0' requires the match be at\n  // the exact location specified, a threshold of '1000' would require a perfect match\n  // to be within 800 characters of the fuzzy location to be found using a 0.8 threshold.\n  distance: 100,\n  // Minimum number of characters that must be matched before a result is considered a match\n  findAllMatches: false,\n  // The get function to use when fetching an object's properties.\n  // The default will search nested paths *ie foo.bar.baz*\n  getFn: get,\n  includeMatches: false,\n  includeScore: false,\n  // List of properties that will be searched. This also supports nested properties.\n  keys: [],\n  // Approximately where in the text is the pattern expected to be found?\n  location: 0,\n  // Minimum number of characters that must be matched before a result is considered a match\n  minMatchCharLength: 1,\n  // Whether to sort the result list, by score\n  shouldSort: true,\n  // Default sort function\n  sortFn: (a, b) => (a.score - b.score),\n  // At what point does the match algorithm give up. A threshold of '0.0' requires a perfect match\n  // (of both letters and location), a threshold of '1.0' would match anything.\n  threshold: 0.6,\n  // Enabled extended-searching\n  useExtendedSearch: false\n}\n\nclass Fuse {\n  constructor(list, options = FuseOptions, index = null) {\n    this.options = { ...FuseOptions, ...options }\n    // `caseSensitive` is deprecated, use `isCaseSensitive` instead\n    this.options.isCaseSensitive = options.caseSensitive\n    delete this.options.caseSensitive\n\n    // debugTime('Constructing')\n    this._processKeys(this.options.keys)\n    this.setCollection(list, index)\n    // debugTimeEnd('Constructing')\n  }\n\n  setCollection(list, index = null) {\n    this.list = list\n    this.listIsStringArray = isString(list[0])\n\n    if (index) {\n      this.setIndex(index)\n    } else {\n      // debugTime('Process index')\n      this.setIndex(this._createIndex())\n      // debugTimeEnd('Process index')\n    }\n  }\n\n  setIndex(listIndex) {\n    this._indexedList = listIndex\n    // debug(listIndex)\n  }\n\n  _processKeys(keys) {\n    this._keyStore = new KeyStore(keys)\n\n    // debug('Process Keys')\n    if (Fuse.verbose) {\n      // debug(this._keyStore.toJSON())\n    }\n  }\n\n  _createIndex() {\n    return createIndex(this._keyStore.keys(), this.list, {\n      getFn: this.options.getFn\n    })\n  }\n\n  search(pattern, opts = { limit: false }) {\n    // debug(`--------- Search pattern: \"${pattern}\"`)\n    const { useExtendedSearch, shouldSort } = this.options\n\n    let searcher = null\n\n    if (useExtendedSearch) {\n      searcher = new ExtendedSearch(pattern, this.options)\n    } else if (pattern.length > MAX_BITS) {\n      searcher = new NGramSearch(pattern, this.options)\n    } else {\n      searcher = new BitapSearch(pattern, this.options)\n    }\n\n    // debugTime('Search time');\n    let results = this._searchUsing(searcher)\n    // debugTimeEnd('Search time');\n\n    // debugTime('Compute score time');\n    this._computeScore(results)\n    // debugTimeEnd('Compute score time');\n\n    if (shouldSort) {\n      this._sort(results)\n    }\n\n    if (opts.limit && isNumber(opts.limit)) {\n      results = results.slice(0, opts.limit)\n    }\n\n    return this._format(results)\n  }\n\n  _searchUsing(searcher) {\n    const list = this._indexedList\n    const results = []\n    const { includeMatches } = this.options\n\n    // List is Array<String>\n    if (this.listIsStringArray) {\n      // Iterate over every string in the list\n      for (let i = 0, len = list.length; i < len; i += 1) {\n        let value = list[i]\n        let { $: text, idx } = value\n\n        if (!isDefined(text)) {\n          continue\n        }\n\n        let searchResult = searcher.searchIn(value)\n\n        const { isMatch, score } = searchResult\n\n        if (!isMatch) {\n          continue\n        }\n\n        let match = { score, value: text }\n\n        if (includeMatches) {\n          match.indices = searchResult.matchedIndices\n        }\n\n        results.push({\n          item: text,\n          idx,\n          matches: [match]\n        })\n      }\n\n    } else {\n      // List is Array<Object>\n      const keyNames = this._keyStore.keys()\n      const keysLen = this._keyStore.count()\n\n      for (let i = 0, len = list.length; i < len; i += 1) {\n        let { $: item, idx } = list[i]\n\n        if (!isDefined(item)) {\n          continue\n        }\n\n        let matches = []\n\n        // Iterate over every key (i.e, path), and fetch the value at that key\n        for (let j = 0; j < keysLen; j += 1) {\n          let key = keyNames[j]\n          let value = item[key]\n\n          // debug(` Key: ${key === '' ? '--' : key}`)\n\n          if (!isDefined(value)) {\n            continue\n          }\n\n          if (isArray(value)) {\n            for (let k = 0, len = value.length; k < len; k += 1) {\n              let arrItem = value[k]\n              let text = arrItem.$\n              let idx = arrItem.idx\n\n              if (!isDefined(text)) {\n                continue\n              }\n\n              let searchResult = searcher.searchIn(arrItem)\n\n              const { isMatch, score } = searchResult\n\n              // debug(`Full text: \"${text}\", score: ${score}`)\n\n              if (!isMatch) {\n                continue\n              }\n\n              let match = { score, key, value: text, idx }\n\n              if (includeMatches) {\n                match.indices = searchResult.matchedIndices\n              }\n\n              matches.push(match)\n            }\n          } else {\n            let text = value.$\n            let searchResult = searcher.searchIn(value)\n\n            const { isMatch, score } = searchResult\n\n            // debug(`Full text: \"${text}\", score: ${score}`)\n\n            if (!isMatch) {\n              continue\n            }\n\n            let match = { score, key, value: text }\n\n            if (includeMatches) {\n              match.indices = searchResult.matchedIndices\n            }\n\n            matches.push(match)\n          }\n        }\n\n        if (matches.length) {\n          results.push({\n            idx,\n            item,\n            matches\n          })\n        }\n      }\n    }\n\n    // debug(\"--------- RESULTS -----------\")\n    // debug(results)\n    // debug(\"-----------------------------\")\n\n    return results\n  }\n\n  _computeScore(results) {\n    // debug('Computing score: ')\n\n    for (let i = 0, len = results.length; i < len; i += 1) {\n      const result = results[i]\n      const matches = result.matches\n      const scoreLen = matches.length\n\n      let totalWeightedScore = 1\n      // let bestScore = -1\n\n      for (let j = 0; j < scoreLen; j += 1) {\n        const item = matches[j]\n        const key = item.key\n        const keyWeight = this._keyStore.get(key, 'weight')\n        const weight = keyWeight > -1 ? keyWeight : 1\n        const score = item.score === 0 && keyWeight > -1\n          ? Number.EPSILON\n          : item.score\n\n        totalWeightedScore *= Math.pow(score, weight)\n\n        // Keep track of the best score.. just in case\n        // Actually, we're not really using it.. but need to think of a way to incorporate this\n        // bestScore = bestScore == -1 ? item.score : Math.min(bestScore, item.score)\n      }\n\n      result.score = totalWeightedScore\n      // result.$score = bestScore\n\n      // debug(result)\n    }\n  }\n\n  _sort(results) {\n    // debug('Sorting....')\n    results.sort(this.options.sortFn)\n  }\n\n  _format(results) {\n    const finalOutput = []\n\n    const { includeMatches, includeScore, } = this.options\n\n    // if (Fuse.verbose) {\n    //   let cache = []\n    //   debug('Output:', JSON.stringify(results, (key, value) => {\n    //     if (isObject(value) && isDefined(value)) {\n    //       if (cache.indexOf(value) !== -1) {\n    //         // Circular reference found, discard key\n    //         return\n    //       }\n    //       // Store value in our collection\n    //       cache.push(value)\n    //     }\n    //     return value\n    //   }, 2))\n    //   cache = null\n    // }\n\n    let transformers = []\n\n    if (includeMatches) transformers.push(transformMatches)\n    if (includeScore) transformers.push(transformScore)\n\n    // debug(\"===== RESULTS ======\")\n    // debug(results)\n    // debug(\"====================\")\n\n    for (let i = 0, len = results.length; i < len; i += 1) {\n      const result = results[i]\n\n      // debug('result', result)\n\n      const { idx } = result\n\n      const data = {\n        item: this.list[idx],\n        refIndex: idx\n      }\n\n      if (transformers.length) {\n        for (let j = 0, len = transformers.length; j < len; j += 1) {\n          transformers[j](result, data)\n        }\n      }\n\n\n      finalOutput.push(data)\n    }\n\n    return finalOutput\n  }\n}\n\nFuse.createIndex = createIndex\n\nmodule.exports = Fuse\n"],"names":["pattern","errors","currentLocation","expectedLocation","distance","accuracy","length","proximity","Math","abs","matchmask","minMatchCharLength","matchedIndices","start","end","i","len","match","push","text","patternAlphabet","location","threshold","findAllMatches","includeMatches","patternLen","textLen","max","min","currentThreshold","bestLocation","indexOf","matchMask","score","bitapScore","lastIndexOf","lastBitArr","finalScore","binMax","mask","binMin","binMid","floor","finish","bitArr","Array","j","charMatch","charAt","result","isMatch","MAX_BITS","require$$0","BitapSearch","isCaseSensitive","options","Error","toLowerCase","value","$","searchInString","bitapSearch","isForPattern","sanitize","substr","sanitizedPattern","index","startsWith","endsWith","substring","INFINITY","isArray","Object","prototype","toString","call","baseToString","isString","isNumber","isObject","isDefined","undefined","queryfy","split","map","item","trim","ExtendedSearch","query","_fuzzyCache","matchFound","qLen","parts","pLen","token","_search","exactMatch","prefixExactMatch","inversePrefixExactMatch","inverseSuffixExactMatch","suffixExactMatch","inverseExactMatch","searcher","NGRAM_LEN","n","pad","sort","nGrams","a","b","arr1","arr2","item1","item2","union","intersection","require$$1","nGram1","nGram2","nGramUnion","nGramIntersection","jaccardDistance","NGramSearch","patternNgram","ngram","textNgram","ng","jacardResult","require$$2","obj","path","list","arr","_get","dotIndex","key","remaining","slice","keys","getFn","get","ngrams","indexedList","record","idx","keysLen","subRecords","stack","arrayIndex","pop","subRecord","k","arrLen","KeyStore","_keys","_keyNames","_length","weight","totalWeight","hasOwnProperty","keyName","name","keyWeight","JSON","stringify","createIndex","data","matches","indices","refIndex","transformMatches","transformScore","require$$3","require$$4","FuseOptions","includeScore","shouldSort","sortFn","useExtendedSearch","Fuse","caseSensitive","_processKeys","setCollection","listIsStringArray","setIndex","_createIndex","listIndex","_indexedList","_keyStore","opts","limit","results","_searchUsing","_computeScore","_sort","_format","searchResult","searchIn","keyNames","count","arrItem","scoreLen","totalWeightedScore","Number","EPSILON","pow","finalOutput","transformers"],"mappings":"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"}