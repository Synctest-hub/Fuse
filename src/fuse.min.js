/**
 * @license
 * Fuse - Lightweight fuzzy-search
 *
 * Copyright (c) 2012 Kirollos Risk <kirollos@gmail.com>.
 * All Rights Reserved. Apache Software License 2.0
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(t){function n(t,e){this.list=t,this.options=e=e||{},this.options.sort="sort"in e?e.sort:n.defaultOptions.sort,this.options.includeScore="includeScore"in e?e.includeScore:n.defaultOptions.includeScore,this.options.searchFn=e.searchFn||n.defaultOptions.searchFn,this.options.sortFn=e.sortFn||n.defaultOptions.sortFn,this.options.keys=e.keys||n.defaultOptions.keys}var e=function(t){return"[object Array]"==toString.call(t)},r=function(t){return t},i=function(t,n){return null!=t&&hasOwnProperty.call(t,n)},o=function(t,n,e){n||(n=r);var i=!0;return null==t?i:(a(t,function(t,r,o){return(i=i&&n.call(e,t,r,o))?void 0:breaker}),!!i)},s=function(t){if(!_isObject(t))return[];if(nativeKeys)return nativeKeys(t);var n=[];for(var e in t)i(t,e)&&n.push(e);return n},a=function(t,n,e){if(null==t)return t;if(t.length===+t.length){for(var r=0,i=t.length;i>r;r++)if(n.call(e,t[r],r,t)===breaker)return}else for(var o=s(t),r=0,i=o.length;i>r;r++)if(n.call(e,t[o[r]],o[r],t)===breaker)return;return t},h=function(t){return i(t,"callee")},c=function(t,n,r,i){if(n&&o(t,e))return concat.apply(i,t);for(var s=0,a=t.length;a>s;s++){var l=t[s];e(l)||h(l)?n?push.apply(i,l):c(l,n,r,i):r||i.push(l)}return i},l=function(t,n){return c(t,n,!1,[])},u=function(t,n){if(n=n||{},this.options=n,this.options.location=n.location||u.defaultOptions.location,this.options.distance="distance"in n?n.distance:u.defaultOptions.distance,this.options.threshold="threshold"in n?n.threshold:u.defaultOptions.threshold,this.options.maxPatternLength=n.maxPatternLength||u.defaultOptions.maxPatternLength,this.pattern=n.caseSensitive?t:t.toLowerCase(),this.patternLen=t.length,this.patternLen>this.options.maxPatternLength)throw new Error("Pattern length is too long");this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet()};u.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},u.prototype._calculatePatternAlphabet=function(){var t={},n=0;for(n=0;n<this.patternLen;n++)t[this.pattern.charAt(n)]=0;for(n=0;n<this.patternLen;n++)t[this.pattern.charAt(n)]|=1<<this.pattern.length-n-1;return t},u.prototype._bitapScore=function(t,n){var e=t/this.patternLen,r=Math.abs(this.options.location-n);return this.options.distance?e+r/this.options.distance:r?1:e},u.prototype.search=function(t){if(t=this.options.caseSensitive?t:t.toLowerCase(),this.pattern===t)return{isMatch:!0,score:0};var n,e,r,i,o,s,a,h,c,l=t.length,p=this.options.location,u=this.options.threshold,f=t.indexOf(this.pattern,p),d=this.patternLen+l,v=1,b=[];for(-1!=f&&(u=Math.min(this._bitapScore(0,f),u),f=t.lastIndexOf(this.pattern,p+this.patternLen),-1!=f&&(u=Math.min(this._bitapScore(0,f),u))),f=-1,n=0;n<this.patternLen;n++){for(r=0,i=d;i>r;)this._bitapScore(n,p+i)<=u?r=i:d=i,i=Math.floor((d-r)/2+r);for(d=i,o=Math.max(1,p-i+1),s=Math.min(p+i,l)+this.patternLen,a=Array(s+2),a[s+1]=(1<<n)-1,e=s;e>=o;e--)if(c=this.patternAlphabet[t.charAt(e-1)],a[e]=0===n?(1|a[e+1]<<1)&c:(1|a[e+1]<<1)&c|(1|(h[e+1]|h[e])<<1)|h[e+1],a[e]&this.matchmask&&(v=this._bitapScore(n,e-1),u>=v)){if(u=v,f=e-1,b.push(f),!(f>p))break;o=Math.max(1,2*p-f)}if(this._bitapScore(n+1,p)>u)break;h=a}return{isMatch:f>=0,score:v}};var f={deepValue:function(t,n){for(var r=0,n=n.split("."),i=n.length;i>r;r++){if(!t)return null;if("[]"===n[r].slice(0,2)){if(p=n[r].slice(2),e(t)){newObj=[];for(var o=0;o<t.length;o++)newObj.push(t[o][p]);t=l(newObj)}}else if(e(t)){newObj=[];for(var o=0;o<t.length;o++)newObj.push(t[o][n[r]]);t=l(newObj)}else t=t[n[r]]}return t}};n.defaultOptions={id:null,caseSensitive:!1,includeScore:!1,shouldSort:!0,searchFn:u,sortFn:function(t,n){return t.score-n.score},keys:[]},n.prototype.search=function(t){var n,r,i,o,s,a=new this.options.searchFn(t,this.options),h=this.list,c=h.length,l=this.options,p=this.options.keys,u=p.length,d=[],v={},b=[],g=function(t,n,r){if(void 0!=t&&null!=t){e(t)||(t=[t]);for(var i=0;i<t.length;i++){var h=t[i];"string"==typeof h&&(o=a.search(h),o.isMatch&&(s=v[r],s?s.score=Math.min(s.score,o.score):(v[r]={item:n,score:o.score},d.push(v[r]))))}}};if("string"==typeof h[0])for(var n=0;c>n;n++)g(h[n],n,n);else for(var n=0;c>n;n++)for(i=h[n],r=0;u>r;r++)g(f.deepValue(i,p[r]),i,n);l.shouldSort&&d.sort(l.sortFn);for(var O=l.includeScore?function(t){return d[t]}:function(t){return d[t].item},y=l.id?function(t){return f.deepValue(O(t),l.id)}:function(t){return O(t)},n=0,m=d.length;m>n;n++)b.push(y(n));return b},"object"==typeof exports?module.exports=n:"function"==typeof define&&define.amd?define(function(){return n}):t.Fuse=n}(this);