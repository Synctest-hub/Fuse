/**
 * @license
 * Fuse - Lightweight fuzzy-search
 *
 * Copyright (c) 2012 Kirollos Risk <kirollos@gmail.com>.
 * All Rights Reserved. Apache Software License 2.0
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
!function(t){function e(t,n){this.list=t,this.options=n=n||{};var i,r,o,s;for(i=0,s=["sort","includeScore","shouldSort"],r=s.length;r>i;i++)o=s[i],this.options[o]=o in n?n[o]:e.defaultOptions[o];for(i=0,s=["searchFn","sortFn","scoreStrategy","keys","getFn"],r=s.length;r>i;i++)o=s[i],this.options[o]=n[o]||e.defaultOptions[o]}function n(t,e){return"min"===e?Math.min.apply(null,t):"weighted"===e?i(t):0}function i(t){for(var e=0,n=r(t),i=0,o=t.length;o>i;i++)e+=t[i];return e/o-.1*n}function r(t){for(var e=Math.min.apply(null,t),n=0,i=0,r=t.length;r>i;i++)n+=t[i]==e?1:0;return n}var o=-10,s=function(t,e){if(e=e||{},this.options=e,this.options.location=e.location||s.defaultOptions.location,this.options.distance="distance"in e?e.distance:s.defaultOptions.distance,this.options.threshold="threshold"in e?e.threshold:s.defaultOptions.threshold,this.options.maxPatternLength=e.maxPatternLength||s.defaultOptions.maxPatternLength,this.pattern=e.caseSensitive?t:t.toLowerCase(),this.patternLen=t.length,this.patternLen>this.options.maxPatternLength)throw new Error("Pattern length is too long");this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet()};s.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},s.prototype._calculatePatternAlphabet=function(){var t={},e=0;for(e=0;e<this.patternLen;e++)t[this.pattern.charAt(e)]=0;for(e=0;e<this.patternLen;e++)t[this.pattern.charAt(e)]|=1<<this.pattern.length-e-1;return t},s.prototype._bitapScore=function(t,e){var n=t/this.patternLen,i=Math.abs(this.options.location-e);return this.options.distance?n+i/this.options.distance:i?1:n},s.prototype.search=function(t){if(t=this.options.caseSensitive?t:t.toLowerCase(),this.pattern===t)return{isMatch:!0,score:o};var e,n,i,r,s,a,h,c,p,l=t.length,f=this.options.location,u=this.options.threshold,d=t.indexOf(this.pattern,f),g=this.patternLen+l,m=1,y=[];for(-1!=d&&(u=Math.min(this._bitapScore(0,d),u),d=t.lastIndexOf(this.pattern,f+this.patternLen),-1!=d&&(u=Math.min(this._bitapScore(0,d),u))),d=-1,e=0;e<this.patternLen;e++){for(i=0,r=g;r>i;)this._bitapScore(e,f+r)<=u?i=r:g=r,r=Math.floor((g-i)/2+i);for(g=r,s=Math.max(1,f-r+1),a=Math.min(f+r,l)+this.patternLen,h=Array(a+2),h[a+1]=(1<<e)-1,n=a;n>=s;n--)if(p=this.patternAlphabet[t.charAt(n-1)],h[n]=0===e?(h[n+1]<<1|1)&p:(h[n+1]<<1|1)&p|((c[n+1]|c[n])<<1|1)|c[n+1],h[n]&this.matchmask&&(m=this._bitapScore(e,n-1),u>=m)){if(u=m,d=n-1,y.push(d),!(d>f))break;s=Math.max(1,2*f-d)}if(this._bitapScore(e+1,f)>u)break;c=h}return{isMatch:d>=0,score:m}};var a=function(t,e,n){var i,r,o;if(e){o=e.indexOf("."),-1!==o?(i=e.slice(0,o),r=e.slice(o+1)):i=e;var s=t[i];if(s)if(r||"string"!=typeof s&&"number"!=typeof s)if(h.isArray(s))for(var c=0,p=s.length;p>c;c++)a(s[c],r,n);else r&&a(s,r,n);else n.push(s)}else n.push(t);return n},h={deepValue:function(t,e){return a(t,e,[])},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)}};e.defaultOptions={id:null,caseSensitive:!1,includeScore:!1,shouldSort:!0,searchFn:s,sortFn:function(t,e){return t.score-e.score},getFn:h.deepValue,keys:[],scoreStrategy:"min"},e.prototype.search=function(t){var e,i,r,o,s=new this.options.searchFn(t,this.options),a=this.list,c=a.length,p=this.options,l=this.options.keys,f=l.length,u=[],d={},g=[],m=function(t,e,n){if(void 0!==t&&null!==t)if("string"==typeof t)r=s.search(t),r.isMatch&&(o=d[n],o?o.scoreList.push(r.score):(d[n]={item:e,scoreList:[r.score]},u.push(d[n])));else if(h.isArray(t))for(var i=0;i<t.length;i++)m(t[i],e,n)};if("string"==typeof a[0])for(var y=0;c>y;y++)m(a[y],y,y);else for(var y=0;c>y;y++)for(i=a[y],e=0;f>e;e++)m(p.getFn(i,l[e]),i,y);for(var y=0,v=u.length;v>y;y++)u[y].score=n(u[y].scoreList,p.scoreStrategy);p.shouldSort&&u.sort(p.sortFn);for(var L=p.includeScore?function(t){return u[t]}:function(t){return u[t].item},S=p.id?function(t){u[t].item=p.getFn(u[t].item,p.id)[0]}:function(){},y=0,v=u.length;v>y;y++)S(y),g.push(L(y));return g},"object"==typeof exports?module.exports=e:"function"==typeof define&&define.amd?define(function(){return e}):t.Fuse=e}(this);